---
- name: 02-PREP_mkdir_/etc/default
  ansible.builtin.file:
    path: /etc/default
    state: directory
    mode: "0755"

- name: 02-PREP_touch_/etc/login.defs
  ansible.builtin.file:
    path: /etc/login.defs
    state: touch
    access_time: preserve

- name: 02-PREP_touch_/etc/default/useradd
  ansible.builtin.file:
    path: /etc/default/useradd
    state: touch
    access_time: preserve

- name: 02-PREP_set_net.ipv4.ip_forward=1
  sysctl:
    name: net.ipv4.ip_forward
    value: "1"
    state: present
    reload: yes

- name: O2-PREP_daily_rmi_prune
  ansible.builtin.cron:
    name: "prune"
    minute: "0"
    hour: "2"
    job: "k3s crictl rmi --prune"

- name: O2-PREP_daily_apk_updates
  ansible.builtin.cron:
    name: "updates"
    minute: "0"
    hour: "3"
    job: "apk update && apk upgrade && rm -rf /var/cache/apk/*"

- name: O2-PREP_weekly_reboot
  ansible.builtin.cron:
    name: "Reboot"
    weekday: "0"
    minute: "0"
    hour: "6"
    job: "reboot 0"
