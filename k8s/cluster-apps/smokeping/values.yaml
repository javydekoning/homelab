#
# IMPORTANT NOTE
#
# This chart inherits from our common library chart. You can check the default values/options here:
# https://github.com/k8s-at-home/library-charts/tree/main/charts/stable/common/values.yaml
#

controller:
  # -- Number of pods to load balance between
  replicas: 1

initContainers:
  # -- Configures an initContainer that copies the configmap to the smokeping conf directory
  # It does NOT overwrite when the file already exists.
  # @default -- See values.yaml
  copy-configmap:
    image: busybox
    imagePullPolicy: Always
    command:
      - "sh"
      - "-c"
      - cp -n /tmp/* /config
    volumeMounts:
      - name: smokeping-config
        mountPath: /tmp
      - name: config
        mountPath: /config
    securityContext:
      runAsUser: 0

image:
  # -- image repository
  repository: linuxserver/smokeping
  # -- image tag
  tag: "2.7.3"
  # -- image pull policy
  pullPolicy: Always

# -- environment variables. See more environment variables in the [beets documentation](https://beets.org/docs).
# @default -- See below
env:
  # -- Set the container timezone
  TZ: UTC
  # -- Set the container user id
  PUID: "1000"
  # -- Set the container group id
  PGID: "1000"

# -- Configures service settings for the chart.
# @default -- See values.yaml
service:
  main:
    primary: true
    ports:
      http:
        port: 80

# -- Configure persistence settings for the chart under this key.
# @default -- See values.yaml
persistence:
  config:
    enabled: true
    mountPath: /config
  data:
    enabled: false
    mountPath: /data

# config -- Smokeping configuration. For a full list of options see https://oss.oetiker.ch/smokeping/doc/smokeping_config.en.html
# @default -- See values.yaml
config:
  alerts:
  # Probes -- Smoke ping probes. See documentation https://oss.oetiker.ch/smokeping/doc/smokeping_config.en.html#I____Probes______mandatory_section_
  # @default -- Generated
  probes:
  # Probes -- Smoke ping probes. See documentation https://oss.oetiker.ch/smokeping/doc/smokeping_config.en.html#I____Targets______mandatory_section_
  # @default -- Generated
  targets: |
    *** Targets ***

    menu = Top
    title = Network Latency
    remark = Sample Remark
    probe = FPing

    + FPing
    menu = FPing Latency
    title = FPing Latency

    ++ k8s-at-home
    menu = k8s-at-home
    title = k8s-at-home
    host = k8s-at-home.com

    ++ Google
    menu = Google
    title = google.com
    host = google.com

    + DNS
    probe = DNS
    menu = DNS
    title = DNS Latency

    ++ k8s-at-home

    menu = k8s-at-home
    host = google 8.8.4.4 k8s-at-home.com
    lookup = k8s-at-home.com
    server = 8.8.4.4

ingress:
  main:
    enabled: true
    ingressClassName: "nginx"
    hosts:
      - host: smokeping.k8s.javydekoning.com
        paths:
          - path: /
