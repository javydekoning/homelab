# RFC 3164 Syslog Parser
[PARSER]
    name        syslog-rfc3164
    format      regex
    regex       ^(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    time_key    time
    time_format %b %d %H:%M:%S
    time_keep   on

# RFC 5424 Syslog Parser
[PARSER]
    Name        syslog-rfc5424
    Format      regex
    Regex       ^\<(?<pri>[0-9]{1,5})\>1 (?<time>[^ ]+) (?<host>[^ ]+) (?<ident>[^ ]+) (?<pid>[-0-9]+) (?<msgid>[^ ]+) (?<extradata>(\[(.*?)\]|-)) (?<message>.+)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

# CEF (Common Event Format) Parser
[PARSER]
    name        cef
    format      regex
    regex       ^CEF:(?<cef_version>[0-9]+)\|(?<device_vendor>[^|]*)\|(?<device_product>[^|]*)\|(?<device_version>[^|]*)\|(?<device_event_class_id>[^|]*)\|(?<name>[^|]*)\|(?<severity>[^|]*)(\|(?<extensions>.*))?$
    types       cef_version:integer,severity:integer

# Generic key=value parser for CEF extensions
[PARSER]
    name        cef_extensions
    format      regex
    regex       (?<key>[^=]+)=(?<value>[^ ]+)

# Alternative: JSON parser for structured logs
[PARSER]
    name        json
    format      json
    time_key    timestamp
    time_format %Y-%m-%dT%H:%M:%S.%L%z
    time_keep   on

# Docker logs parser (if collecting from containers)
[PARSER]
    name        docker
    format      json
    time_key    time
    time_format %Y-%m-%dT%H:%M:%S.%L%z
    time_keep   on
