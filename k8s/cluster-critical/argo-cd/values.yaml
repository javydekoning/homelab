argo-cd:
  configs:
    cm:
      oidc.config: |
        name: Authelia
        issuer: https://auth.lab.javydekoning.com
        clientID: argocd
        clientSecret: $oidc.OIDC_CLIENT_SECRET
        requestedScopes: ["openid", "profile", "email", "groups"]
        requestedIDTokenClaims: {"groups": {"essential": true}}
        logoutURL: https://auth.lab.javydekoning.com/api/oidc/logout
    rbac:
      policy.default: role:readonly
      policy.csv: |
        p, role:admin, applications, *, */*, allow
        p, role:admin, clusters, *, *, allow
        p, role:admin, repositories, *, *, allow
        p, role:admin, certificates, *, *, allow
        p, role:admin, accounts, *, *, allow
        p, role:admin, gpgkeys, *, *, allow
        p, role:admin, logs, *, *, allow
        p, role:admin, exec, *, *, allow
        p, role:admin, extensions, *, *, allow
        g, admins, role:admin
    params:
      server.insecure: true

  controller:
    replicas: 1
    metrics:
      enabled: true
      serviceMonitor:
        enabled: true

  server:
    ingress:
      enabled: true
      ingressClassName: "nginx"
      hostname: argocd.k8s.javydekoning.com
      annotations:
        nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
        nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
      extraTls:
        - hosts:
            - argocd.k8s.javydekoning.com
          secretName: javydekoning-com-tls

    autoscaling:
      enabled: true
      minReplicas: 1

  repoServer:
    autoscaling:
      enabled: true
      minReplicas: 1

  applicationSet:
    replicaCount: 1
