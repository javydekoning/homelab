global:
  domain: argocd.k8s.javydekoning.com
configs:
  cm:
    kustomize.buildOptions: --enable-helm
    oidc.config: |
      name: "Pocket ID"
      issuer: https://pocket-id.lab.javydekoning.com
      clientID: $oidc:OIDC_CLIENT_ID
      clientSecret: $oidc:OIDC_CLIENT_SECRET
      requestedScopes:
        - 'openid'
        - 'email'
        - 'groups'
      enableUserInfoGroups: true
      userInfoPath: '/api/oidc/userinfo'
  rbac:
    policy.default: role:readonly
    policy.csv: |
      g, admins, role:admin
  params:
    server.insecure: true

controller:
  replicas: 1
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true

server:
  ingress:
    enabled: true
    ingressClassName: "nginx"
    hostname: argocd.k8s.javydekoning.com
    annotations:
      nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
      nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
    extraTls:
      - hosts:
          - argocd.k8s.javydekoning.com
        secretName: javydekoning-com-tls

  autoscaling:
    enabled: true
    minReplicas: 1

repoServer:
  autoscaling:
    enabled: true
    minReplicas: 1

applicationSet:
  replicaCount: 1
