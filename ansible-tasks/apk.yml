- name: set repositories
  copy:
    dest: "/etc/apk/repositories"
    content: |
      http://dl-3.alpinelinux.org/alpine/latest-stable/main
      http://dl-3.alpinelinux.org/alpine/latest-stable/community

- name: install apk packages
  become: true
  retries: 3  # If Python is upgraded, a retry might be needed.
  community.general.apk:
    name: "{{ apk_installed_packages }}"
    state: latest
    update_cache: yes

- name: Update all installed packages to the latest versions
  become: true
  community.general.apk:
    upgrade: yes
